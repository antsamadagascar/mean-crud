<div class="container">
  <!-- Formulaire d'ajout -->
  <div class="article-form">
    <h2>Ajouter un nouvel article</h2>
    <form (ngSubmit)="addArticle()" #articleForm="ngForm">
      <div class="form-row">
        <div class="form-group">
          <label for="title">Titre de l'article</label>
          <input
            type="text"
            id="title"
            name="title"
            [(ngModel)]="newArticle.title"
            placeholder="Ex: Les dernières actualités tech"
            required
          />
        </div>

        <div class="form-group">
          <label for="category">Catégorie</label>
          <select
            id="category"
            name="category"
            [(ngModel)]="newArticle.category"
            required
          >
            <option *ngFor="let cat of categories" [value]="cat">
              {{ cat }}
            </option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label for="content">Contenu de l'article</label>
        <textarea
          id="content"
          name="content"
          [(ngModel)]="newArticle.content"
          placeholder="Rédigez le contenu de votre article ici..."
          rows="5"
          required
        ></textarea>
      </div>

      <button type="submit" [disabled]="articleForm.invalid" class="btn-submit">
        <span *ngIf="!articleForm.invalid">✓ Publier l'article</span>
        <span *ngIf="articleForm.invalid">⚠ Remplissez tous les champs</span>
      </button>
    </form>
  </div>

  <!-- Liste des articles -->
  <div class="articles-section">
    <div class="section-header">
      <h2> Tous les articles</h2>
      <span class="article-count">{{ articles.length }} article(s)</span>
    </div>

    <div class="no-articles" *ngIf="articles.length === 0">
      <div class="empty-state">
        <span class="empty-icon"></span>
        <p>Aucun article pour le moment</p>
        <small>Ajoutez votre premier article ci-dessus</small>
      </div>
    </div>

    <div class="articles-grid">
      <div 
        class="article-card" 
        *ngFor="let article of articles"
        [ngClass]="getCategoryClass(article.category)"
      >

        <!-- MODE AFFICHAGE -->
        <div *ngIf="editingArticleId !== article._id">

          <div class="article-category-badge">
            {{ article.category }}
          </div>

          <h3 class="article-title">{{ article.title }}</h3>

          <p class="article-content">{{ article.content }}</p>

          <div class="article-footer">
            <span class="article-date">
              {{ article.createdAt | date: 'dd/MM/yyyy à HH:mm' }}
            </span>

            <div class="article-actions">
              <button 
                (click)="startEdit(article)" 
                class="btn-edit"
                title="Modifier"
              >
                Modifier
              </button>

              <button 
                (click)="deleteArticle(article._id)" 
                class="btn-delete"
                title="Supprimer"
              >
                Supprimer
              </button>
            </div>
          </div>

        </div>

        <!--  MODE ÉDITION -->
        <div *ngIf="editingArticleId === article._id" class="edit-form">

          <input
            type="text"
            [(ngModel)]="editArticle.title"
            placeholder="Titre de l'article"
          />

          <select [(ngModel)]="editArticle.category">
            <option *ngFor="let cat of categories" [value]="cat">
              {{ cat }}
            </option>
          </select>

          <textarea
            [(ngModel)]="editArticle.content"
            rows="4"
            placeholder="Contenu de l'article"
          ></textarea>

          <div class="edit-actions">
            <button 
              (click)="updateArticle()" 
              class="btn-save"
            >
              Enregistrer
            </button>

            <button 
              (click)="cancelEdit()" 
              class="btn-cancel"
            >
              Annuler
            </button>
          </div>

        </div>

      </div>

    </div>
  </div>
</div>